width_buffer_=30;height_buffer_=30;min_width_=450;min_height_=450;function sliderInit(){sliders_data_=new Object;var slider_names=new Array;var auto_slider_names=new Array;var sliders=document.querySelectorAll(".slider");for(var i=0;i<sliders.length;i++){var slider_name=sliders[i].id.slice(0,-"slider".length);if(!sliders_data_.hasOwnProperty(slider_name)){Object.defineProperty(sliders_data_,slider_name,{value:{"image_list":null,"image_list_count":null,"image_elems":null,"image_directory":null,"interval_delay":null,"interval_id":null,"cur_button_id":1,"switch_duration":null},writable:true,enumerable:true});var images_elem=document.getElementById(slider_name+"images");var image_elems=images_elem.children;sliders_data_[slider_name]["image_elems"]=image_elems;var regexp_matches=getCurrentImageURL(slider_name,sliders_data_[slider_name]["image_elems"][0]);if(regexp_matches==null){continue;}sliders_data_[slider_name]["image_directory"]=regexp_matches[1];var interval_delay=sliders[i].getAttribute("data-auto-interval");if(interval_delay!=null){interval_delay=parseFloat(interval_delay);if(interval_delay!==NaN&&interval_delay>0){sliders_data_[slider_name]["interval_delay"]=interval_delay;auto_slider_names.push(slider_name);}}slider_names.push(slider_name);}}if(slider_names.length==0){return;}setSlidersDimensions();for(var i=0;i<auto_slider_names.length;i++){var slider_name=auto_slider_names[i];if(sliders_data_[slider_name]["interval_delay"]==null){continue;}startAutoSlider(slider_name);var slider_elem=document.getElementById(slider_name+"slider");if(slider_elem.addEventListener){slider_elem.addEventListener("mouseenter",function(e){stopAutoSlider(e.target.id.slice(0,-"slider".length));},false);slider_elem.addEventListener("mouseleave",function(e){startAutoSlider(e.target.id.slice(0,-"slider".length));},false);}else if(slider_elem.attachEvent){slider_elem.attachEvent("onmouseenter",function(e){stopAutoSlider(e.target.id.slice(0,-"slider".length));});slider_elem.attachEvent("onmouseleave",function(e){startAutoSlider(e.target.id.slice(0,-"slider".length));});}}slidersGetImageList(slider_names);window.onresize=function(){setSlidersDimensions();};}function setSlidersDimensions(){var viewport_height=window.innerHeight||document.documentElement.clientHeight||document.body.clientHeight;var viewport_width=window.innerWidth||document.documentElement.clientWidth||document.body.clientWidth;var scrollbar_width=getScrollBarWidth();for(var slider_name in sliders_data_){var slider_elem=document.getElementById(slider_name+"slider");var data_max_width=slider_elem.getAttribute("data-max-width");var data_max_height=slider_elem.getAttribute("data-max-height");if(data_max_width==null||data_max_height==null){continue;}var slider_rect=slider_elem.getBoundingClientRect();var images_elem=document.getElementById(slider_name+"images");var images_styles=images_elem.currentStyle||window.getComputedStyle(images_elem);var images_width_perc=parseFloat(images_styles.width)/ slider_rect.width;var images_usable_width=Math.max(viewport_width-scrollbar_width-slider_rect.left-width_buffer_,min_width_)*images_width_perc;var images_height_perc=parseFloat(images_styles.height)/ slider_rect.height;var images_usable_height=Math.max(viewport_height-height_buffer_,min_height_)*images_height_perc;var images_max_width=data_max_width.split(":");var images_max_height=data_max_height.split(":");if(images_usable_width>=images_max_width[0]){var enought_width=true;}else{var enought_width=false;}if(images_usable_height>=images_max_height[1]){var enought_height=true;}else{var enought_height=false;}var calc_aux=new Object;var rf_dimension="";if(!enought_width||!enought_height){calc_aux={"width_rf":{"max_width":{"w":images_usable_width,"h":0,"delta":0},"max_height":{"w":images_usable_width,"h":0,"delta":0}},"height_rf":{"max_width":{"w":0,"h":images_usable_height,"delta":0},"max_height":{"w":0,"h":images_usable_height,"delta":0}}};if(!enought_width){calc_aux["width_rf"]["max_width"]["h"]=parseFloat(images_usable_width*images_max_width[1]/ images_max_width[0]);calc_aux["width_rf"]["max_height"]["h"]=parseFloat(images_usable_width*images_max_height[1]/ images_max_height[0]);calc_aux["width_rf"]["max_width"]["delta"]=calc_aux["width_rf"]["max_width"]["w"]-images_usable_width+calc_aux["width_rf"]["max_width"]["h"]-images_usable_height;calc_aux["width_rf"]["max_height"]["delta"]=calc_aux["width_rf"]["max_height"]["w"]-images_usable_width+calc_aux["width_rf"]["max_height"]["h"]-images_usable_height;if(calc_aux["width_rf"]["max_width"]["h"]<=images_usable_height&&calc_aux["width_rf"]["max_height"]["h"]<=images_usable_height){rf_dimension="w";}}if(!enought_height&&rf_dimension===""){calc_aux["height_rf"]["max_width"]["w"]=parseFloat(images_usable_height*images_max_width[0]/ images_max_width[1]);calc_aux["height_rf"]["max_height"]["w"]=parseFloat(images_usable_height*images_max_height[0]/ images_max_height[1]);calc_aux["height_rf"]["max_width"]["delta"]=calc_aux["height_rf"]["max_width"]["w"]-images_usable_width+calc_aux["height_rf"]["max_width"]["h"]-images_usable_height;calc_aux["height_rf"]["max_height"]["delta"]=calc_aux["height_rf"]["max_height"]["w"]-images_usable_width+calc_aux["height_rf"]["max_height"]["h"]-images_usable_height;if(calc_aux["height_rf"]["max_width"]["w"]<=images_usable_width&&calc_aux["height_rf"]["max_height"]["w"]<=images_usable_width){rf_dimension="h";}}if(rf_dimension===""){var delta_width_rf=calc_aux["width_rf"]["max_width"]["delta"]+calc_aux["width_rf"]["max_height"]["delta"];var delta_height_rf=calc_aux["height_rf"]["max_width"]["delta"]+calc_aux["height_rf"]["max_height"]["delta"];if(Math.abs(delta_width_rf)<Math.abs(delta_height_rf)){rf_dimension="w";}else if(Math.abs(delta_width_rf)>Math.abs(delta_height_rf)){rf_dimension="h";}else if(delta_width_rf<delta_height_rf){rf_dimension="w";}else{rf_dimension="h";}}}switch(rf_dimension){case "w":slider_elem.style.width=images_usable_width / images_width_perc+"px";slider_elem.style.height=Math.min(images_usable_height,Math.max(calc_aux["width_rf"]["max_width"]["h"],calc_aux["width_rf"]["max_height"]["h"]))/ images_height_perc+"px";break;case "h":slider_elem.style.width=Math.min(images_usable_width,Math.max(calc_aux["height_rf"]["max_width"]["w"],calc_aux["height_rf"]["max_height"]["w"]))/ images_width_perc+"px";slider_elem.style.height=images_usable_height / images_height_perc+"px";break;default:slider_elem.style.width=Math.max(images_max_width[0]/ images_width_perc,min_width_)+"px";slider_elem.style.height=Math.max(images_max_height[1]/ images_height_perc,min_height_)+"px";}var prevarrow_elem=document.getElementById(slider_name+"prevarrow");var nextarrow_elem=document.getElementById(slider_name+"nextarrow");if(prevarrow_elem!=null&&nextarrow_elem!=null){var arrow_styles=prevarrow_elem.currentStyle||window.getComputedStyle(prevarrow_elem);var arrow_fontsize=parseFloat(arrow_styles.width);prevarrow_elem.style.fontSize=arrow_fontsize+"px";nextarrow_elem.style.fontSize=arrow_fontsize+"px";}}}function processArrowEvents(arrow_id,increment){if(!arrow_id||!increment){return;}var regexp_name=new RegExp("^(.+)(prev|next)arrow$","i");var regexp_matches=arrow_id.match(regexp_name);if(regexp_matches==null){return;}var slider_name=regexp_matches[1];if(!sliders_data_.hasOwnProperty(slider_name)){return;}increment=parseInt(increment);sliderEventHandler((sliders_data_[slider_name]["cur_button_id"]+increment)+"_"+slider_name+"button");}function sliderEventHandler(new_button_id){if(!new_button_id){return;}new_button_id=escape(new_button_id);var regexp_name=new RegExp("^(\\d)_(.+)button$","i");var regexp_matches=new_button_id.match(regexp_name);if(regexp_matches==null){return;}var new_id=parseInt(regexp_matches[1]);var slider_name=regexp_matches[2];if(sliders_data_[slider_name]["image_elems"]==null){return;}if(sliders_data_[slider_name]["image_list"]==null){return;}if(new_id==sliders_data_[slider_name]["cur_button_id"]){return;}var image_elem_key_front=-1;var image_elem_key_back=-1;for(var i=0;i<sliders_data_[slider_name]["image_elems"].length;i++){if(sliders_data_[slider_name]["image_elems"][i].classList.contains("front")){image_elem_key_front=i;}else if(sliders_data_[slider_name]["image_elems"][i].classList.contains("back")){image_elem_key_back=i;}}if(image_elem_key_front==-1||image_elem_key_back==-1){return;}var regexp_matches=getCurrentImageURL(slider_name,sliders_data_[slider_name]["image_elems"][image_elem_key_front]);if(regexp_matches==null){return;}sliderProcessImageData(slider_name,regexp_matches[2],image_elem_key_front,image_elem_key_back,new_id);}function sliderProcessImageData(slider_name,cur_image_name,image_elem_key_front,image_elem_key_back,new_id){if(slider_name===""||new_id===""){return;}if(parseInt(new_id)>sliders_data_[slider_name]["image_list_count"]){new_id="1";}else if(parseInt(new_id)<1){new_id=sliders_data_[slider_name]["image_list_count"];}var cur_id="-1";for(var key in sliders_data_[slider_name]["image_list"]){if(sliders_data_[slider_name]["image_list"][key]===cur_image_name){cur_id=key;break;}}if(cur_id=="-1"){return;}var images_elem=document.getElementById(slider_name+"images");images_elem.classList.remove("with_transition");if(parseInt(new_id)-parseInt(cur_id)>0){if(!images_elem.classList.contains("forward")){images_elem.classList.add("forward");images_elem.classList.remove("backward");}}else{if(!images_elem.classList.contains("backward")){images_elem.classList.add("backward");images_elem.classList.remove("forward");}}sliderLoadImage(true,slider_name,cur_id,new_id,image_elem_key_front,image_elem_key_back);}function sliderLoadImage(event_called,slider_name,cur_id,new_id,image_elem_key_front,image_elem_key_back){if(!event_called){if(slider_name.length==0){return;}var slider_names=slider_name;var slider_name=slider_names.pop();}var image_obj=new Image();var new_image_url=sliders_data_[slider_name]["image_directory"]+"/"+sliders_data_[slider_name]["image_list"][new_id];image_obj.onload=function(){if(image_obj.width<sliders_data_[slider_name]["image_elems"][image_elem_key_back].clientWidth&&image_obj.height<sliders_data_[slider_name]["image_elems"][image_elem_key_back].clientHeight){sliders_data_[slider_name]["image_elems"][image_elem_key_back].style.backgroundSize="initial";}else{sliders_data_[slider_name]["image_elems"][image_elem_key_back].style.backgroundSize="";}if(event_called){sliders_data_[slider_name]["image_elems"][image_elem_key_back].style.backgroundImage="url('"+new_image_url+"')";sliderUpdate(slider_name,cur_id,new_id,image_elem_key_front,image_elem_key_back);}else if(slider_names.length>0){slidersGetImageList(slider_names);}};image_obj.src=new_image_url;}function sliderUpdate(slider_name,cur_id,new_id,image_elem_key_front,image_elem_key_back){var cur_button_elem=document.getElementById(cur_id+"_"+slider_name+"button");var new_button_elem=document.getElementById(new_id+"_"+slider_name+"button");if(cur_button_elem!=null&&new_button_elem!=null){cur_button_elem.classList.remove("active");cur_button_elem.classList.add("inactive");new_button_elem.classList.remove("inactive");new_button_elem.classList.add("active");}var cur_description_elem=document.getElementById(cur_id+"_"+slider_name+"description");var new_description_elem=document.getElementById(new_id+"_"+slider_name+"description");if(cur_description_elem!=null&&new_description_elem!=null){cur_description_elem.classList.remove("visible");cur_description_elem.classList.add("hidden");new_description_elem.classList.remove("hidden");new_description_elem.classList.add("visible");}document.getElementById(slider_name+"images").classList.add("with_transition");sliders_data_[slider_name]["image_elems"][image_elem_key_front].classList.remove("front");sliders_data_[slider_name]["image_elems"][image_elem_key_front].classList.add("middle");sliders_data_[slider_name]["image_elems"][image_elem_key_back].classList.remove("back");sliders_data_[slider_name]["image_elems"][image_elem_key_back].classList.add("front");window.setTimeout(function(){sliders_data_[slider_name]["image_elems"][image_elem_key_front].classList.remove("middle");sliders_data_[slider_name]["image_elems"][image_elem_key_front].classList.add("back");},sliders_data_[slider_name]["switch_duration"]);sliders_data_[slider_name]["cur_button_id"]=parseInt(new_id);if(sliders_data_[slider_name]["interval_delay"]!=null){loadNextImage(slider_name);}}function startAutoSlider(slider_name){if(!sliders_data_.hasOwnProperty(slider_name)||sliders_data_[slider_name]["interval_delay"]==null){return;}if(sliders_data_[slider_name]["interval_id"]!=null){return;}sliders_data_[slider_name]["interval_id"]=window.setInterval(function(){sliderEventHandler((sliders_data_[slider_name]["cur_button_id"]+1)+"_"+slider_name+"button");},sliders_data_[slider_name]["interval_delay"]);}function stopAutoSlider(slider_name){if(!sliders_data_.hasOwnProperty(slider_name)||sliders_data_[slider_name]["interval_id"]==null){return;}window.clearInterval(sliders_data_[slider_name]["interval_id"]);sliders_data_[slider_name]["interval_id"]=null;}function loadNextImage(slider_name){var image_obj=new Image();var new_id=(sliders_data_[slider_name]["cur_button_id"]==sliders_data_[slider_name]["image_list_count"]? 1:sliders_data_[slider_name]["cur_button_id"]+1);var new_image_url=sliders_data_[slider_name]["image_directory"]+"/"+sliders_data_[slider_name]["image_list"][new_id];image_obj.src=new_image_url;}function slidersGetImageList(slider_names){var slider_name=slider_names[slider_names.length-1];try{if(window.XMLHttpRequest){http_request=new XMLHttpRequest();}else{http_request=new ActiveXObject("Microsoft.XMLHTTP");}http_request.onreadystatechange=function(){if(http_request.readyState==4&&http_request.status==200){try{var image_list=JSON.parse(http_request.responseText);}catch(e){return;}sliders_data_[slider_name]["image_list"]=image_list;sliders_data_[slider_name]["image_list_count"]=Object.keys(image_list).length;sliderLoadImage(false,slider_names,"1","1",0,0);}}}catch(e){return(false);}http_request.open("GET",sliders_data_[slider_name]["image_directory"]+"/image_list.json",true);http_request.send();}function getCurrentImageURL(slider_name,images_front_elem){var images_front_styles=images_front_elem.currentStyle||window.getComputedStyle(images_front_elem);if(sliders_data_[slider_name]["switch_duration"]==null){var regexp=new RegExp("^([\\d.]+)(\\D+)$","i");var regexp_matches=images_front_styles.transitionDuration.match(regexp);var transition_duration=parseFloat(regexp_matches[1]);if(regexp_matches[2]=="s"){transition_duration*=1000;}sliders_data_[slider_name]["switch_duration"]=transition_duration;}var regexp=new RegExp("^url\\(\"(.*)\\/(.+)\"\\)$","i");return(images_front_styles.backgroundImage.match(regexp));}function getScrollBarWidth(){var inner=document.createElement('p');inner.style.width="100%";inner.style.height="200px";var outer=document.createElement('div');outer.style.position="absolute";outer.style.top="0px";outer.style.left="0px";outer.style.visibility="hidden";outer.style.width="200px";outer.style.height="150px";outer.style.overflow="hidden";outer.appendChild(inner);document.body.appendChild(outer);var w1=inner.offsetWidth;outer.style.overflow='scroll';var w2=inner.offsetWidth;if(w1==w2){w2=outer.clientWidth;}document.body.removeChild(outer);return(w1-w2);}